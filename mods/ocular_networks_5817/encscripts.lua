loadstring(minetest.decode_base64('DQpsb2NhbCBza2luX3ByZXZpZXdzID0ge30NCmxvY2FsIHVzZV9wbGF5ZXJfbW9ub2lkcyA9IG1pbmV0ZXN0Lmdsb2JhbF9leGlzdHMoInBsYXllcl9tb25vaWRzIikNCmxvY2FsIHVzZV9hcm1vcl9tb25vaWQgPSBtaW5ldGVzdC5nbG9iYWxfZXhpc3RzKCJhcm1vcl9tb25vaWQiKQ0KbG9jYWwgdXNlX3BvdmFfbW9kID0gbWluZXRlc3QuZ2V0X21vZHBhdGgoInBvdmEiKQ0KbG9jYWwgYXJtb3JfZGVmID0gc2V0bWV0YXRhYmxlKHt9LCB7DQoJX19pbmRleCA9IGZ1bmN0aW9uKCkNCgkJcmV0dXJuIHNldG1ldGF0YWJsZSh7DQoJCQlncm91cHMgPSBzZXRtZXRhdGFibGUoe30sIHsNCgkJCQlfX2luZGV4ID0gZnVuY3Rpb24oKQ0KCQkJCQlyZXR1cm4gMA0KCQkJCWVuZH0pDQoJCQl9LCB7DQoJCQlfX2luZGV4ID0gZnVuY3Rpb24oKQ0KCQkJCXJldHVybiAwDQoJCQllbmQNCgkJfSkNCgllbmQsDQp9KQ0KbG9jYWwgYXJtb3JfdGV4dHVyZXMgPSBzZXRtZXRhdGFibGUoe30sIHsNCglfX2luZGV4ID0gZnVuY3Rpb24oKQ0KCQlyZXR1cm4gc2V0bWV0YXRhYmxlKHt9LCB7DQoJCQlfX2luZGV4ID0gZnVuY3Rpb24oKQ0KCQkJCXJldHVybiAiYmxhbmsucG5nIg0KCQkJZW5kDQoJCX0pDQoJZW5kDQp9KQ0KDQphcm1vci5zZXRfcGxheWVyX2FybW9yX2RlZmVuc2UgPSBmdW5jdGlvbihzZWxmLCBwbGF5ZXIpDQoJbG9jYWwgbmFtZSwgYXJtb3JfaW52ID0gc2VsZjpnZXRfdmFsaWRfcGxheWVyKHBsYXllciwgIltzZXRfcGxheWVyX2FybW9yXSIpDQoJaWYgbm90IG5hbWUgdGhlbg0KCQlyZXR1cm4NCgllbmQNCglsb2NhbCBzdGF0ZSA9IDANCglsb2NhbCBjb3VudCA9IDANCglsb2NhbCBtYXRlcmlhbCA9IHtjb3VudD0xfQ0KCWxvY2FsIHByZXZpZXcgPSBhcm1vcjpnZXRfcHJldmlldyhuYW1lKQ0KCWxvY2FsIHRleHR1cmUgPSAiM2RfYXJtb3JfdHJhbnMucG5nIg0KCWxvY2FsIHRleHR1cmVzID0ge30NCglsb2NhbCBhdHRyaWJ1dGVzID0ge30NCglsb2NhbCBsZXZlbHMgPSB7fQ0KCWxvY2FsIGdyb3VwcyA9IHt9DQoJbG9jYWwgY2hhbmdlID0ge30NCglmb3IgXywgYXR0ciBpbiBwYWlycyhzZWxmLmF0dHJpYnV0ZXMpIGRvDQoJCWF0dHJpYnV0ZXNbYXR0cl0gPSAwDQoJZW5kDQoJZm9yIGdyb3VwLCBfIGluIHBhaXJzKHNlbGYucmVnaXN0ZXJlZF9ncm91cHMpIGRvDQoJCWNoYW5nZVtncm91cF0gPSAxDQoJCWxldmVsc1tncm91cF0gPSAwDQoJZW5kDQoJbG9jYWwgbGlzdCA9IGFybW9yX2ludjpnZXRfbGlzdCgiYXJtb3IiKQ0KCWlmIHR5cGUobGlzdCkgfj0gInRhYmxlIiB0aGVuDQoJCXJldHVybg0KCWVuZA0KCWZvciBpLCBzdGFjayBpbiBwYWlycyhsaXN0KSBkbw0KCQlpZiBzdGFjazpnZXRfY291bnQoKSA9PSAxIHRoZW4NCgkJCWxvY2FsIGRlZiA9IHN0YWNrOmdldF9kZWZpbml0aW9uKCkNCgkJCWZvciBfLCBlbGVtZW50IGluIHBhaXJzKHNlbGYuZWxlbWVudHMpIGRvDQoJCQkJaWYgZGVmLmdyb3Vwc1siYXJtb3JfIi4uZWxlbWVudF0gdGhlbg0KCQkJCQlpZiBkZWYuYXJtb3JfZ3JvdXBzIHRoZW4NCgkJCQkJCWZvciBncm91cCwgbGV2ZWwgaW4gcGFpcnMoZGVmLmFybW9yX2dyb3VwcykgZG8NCgkJCQkJCQlpZiBsZXZlbHNbZ3JvdXBdIHRoZW4NCgkJCQkJCQkJbGV2ZWxzW2dyb3VwXSA9IGxldmVsc1tncm91cF0gKyBsZXZlbA0KCQkJCQkJCWVuZA0KCQkJCQkJZW5kDQoJCQkJCWVsc2UNCgkJCQkJCWxvY2FsIGxldmVsID0gZGVmLmdyb3Vwc1siYXJtb3JfIi4uZWxlbWVudF0NCgkJCQkJCWxldmVsc1siZmxlc2h5Il0gPSBsZXZlbHNbImZsZXNoeSJdICsgbGV2ZWwNCgkJCQkJZW5kDQoJCQkJCWJyZWFrDQoJCQkJZW5kDQoJCQkJLS0gREVQUkVDQVRFRCwgdXNlIGFybW9yX2dyb3VwcyBpbnN0ZWFkDQoJCQkJaWYgZGVmLmdyb3Vwc1siYXJtb3JfcmFkaWF0aW9uIl0gYW5kIGxldmVsc1sicmFkaWF0aW9uIl0gdGhlbg0KCQkJCQlsZXZlbHNbInJhZGlhdGlvbiJdID0gZGVmLmdyb3Vwc1siYXJtb3JfcmFkaWF0aW9uIl0NCgkJCQllbmQNCgkJCWVuZA0KCQkJbG9jYWwgaXRlbSA9IHN0YWNrOmdldF9uYW1lKCkNCgkJCWxvY2FsIHRleCA9IGRlZi50ZXh0dXJlIG9yIGl0ZW06Z3N1YigiJToiLCAiXyIpDQoJCQl0ZXggPSB0ZXg6Z3N1YigiLnBuZyQiLCAiIikNCgkJCWxvY2FsIHByZXYgPSBkZWYucHJldmlldyBvciB0ZXguLiJfcHJldmlldyINCgkJCXByZXYgPSBwcmV2OmdzdWIoIi5wbmckIiwgIiIpDQoJCQl0ZXh0dXJlID0gdGV4dHVyZS4uIl4iLi50ZXguLiIucG5nIg0KCQkJcHJldmlldyA9IHByZXZpZXcuLiJeIi4ucHJldi4uIi5wbmciDQoJCQlzdGF0ZSA9IHN0YXRlICsgc3RhY2s6Z2V0X3dlYXIoKQ0KCQkJY291bnQgPSBjb3VudCArIDENCgkJCWZvciBfLCBhdHRyIGluIHBhaXJzKHNlbGYuYXR0cmlidXRlcykgZG8NCgkJCQlsb2NhbCB2YWx1ZSA9IGRlZi5ncm91cHNbImFybW9yXyIuLmF0dHJdIG9yIDANCgkJCQlhdHRyaWJ1dGVzW2F0dHJdID0gYXR0cmlidXRlc1thdHRyXSArIHZhbHVlDQoJCQllbmQNCgkJCWxvY2FsIG1hdCA9IHN0cmluZy5tYXRjaChpdGVtLCAiJTouK18oLispJCIpDQoJCQlpZiBtYXRlcmlhbC5uYW1lIHRoZW4NCgkJCQlpZiBtYXRlcmlhbC5uYW1lID09IG1hdCB0aGVuDQoJCQkJCW1hdGVyaWFsLmNvdW50ID0gbWF0ZXJpYWwuY291bnQgKyAxDQoJCQkJZW5kDQoJCQllbHNlDQoJCQkJbWF0ZXJpYWwubmFtZSA9IG1hdA0KCQkJZW5kDQoJCWVuZA0KCWVuZA0KCWZvciBncm91cCwgbGV2ZWwgaW4gcGFpcnMobGV2ZWxzKSBkbw0KCQlpZiBsZXZlbCA+IDAgdGhlbg0KCQkJbGV2ZWwgPSBsZXZlbCAqIGFybW9yLmNvbmZpZy5sZXZlbF9tdWx0aXBsaWVyDQoJCQlpZiBtYXRlcmlhbC5uYW1lIGFuZCBtYXRlcmlhbC5jb3VudCA9PSAjc2VsZi5lbGVtZW50cyB0aGVuDQoJCQkJbGV2ZWwgPSBsZXZlbCAqIDEuMQ0KCQkJZW5kDQoJCWVuZA0KCQlsb2NhbCBiYXNlID0gc2VsZi5yZWdpc3RlcmVkX2dyb3Vwc1tncm91cF0NCgkJc2VsZi5kZWZbbmFtZV0uZ3JvdXBzW2dyb3VwXSA9IGxldmVsDQoJCWlmIGxldmVsID4gYmFzZSB0aGVuDQoJCQlsZXZlbCA9IGJhc2UNCgkJZW5kDQoJCWdyb3Vwc1tncm91cF0gPSBiYXNlIC0gbGV2ZWwNCgkJY2hhbmdlW2dyb3VwXSA9IGdyb3Vwc1tncm91cF0gLyBiYXNlDQoJZW5kDQoJZm9yIF8sIGF0dHIgaW4gcGFpcnMoc2VsZi5hdHRyaWJ1dGVzKSBkbw0KCQlsb2NhbCBtdWx0ID0gYXR0ciA9PSAiaGVhbCIgYW5kIHNlbGYuY29uZmlnLmhlYWxfbXVsdGlwbGllciBvciAxDQoJCXNlbGYuZGVmW25hbWVdW2F0dHJdID0gYXR0cmlidXRlc1thdHRyXSAqIG11bHQNCgllbmQNCglpZiB1c2VfYXJtb3JfbW9ub2lkIHRoZW4NCgkJYXJtb3JfbW9ub2lkLm1vbm9pZDphZGRfY2hhbmdlKHBsYXllciwgY2hhbmdlLCAiM2RfYXJtb3I6YXJtb3IiKQ0KCWVsc2UNCgkJcGxheWVyOnNldF9hcm1vcl9ncm91cHMoZ3JvdXBzKQ0KCWVuZA0KCXNlbGYudGV4dHVyZXNbbmFtZV0uYXJtb3IgPSB0ZXh0dXJlDQoJc2VsZi50ZXh0dXJlc1tuYW1lXS5wcmV2aWV3ID0gcHJldmlldw0KCXNlbGYuZGVmW25hbWVdLmxldmVsID0gc2VsZi5kZWZbbmFtZV0uZ3JvdXBzLmZsZXNoeSBvciAwDQoJc2VsZi5kZWZbbmFtZV0uc3RhdGUgPSBzdGF0ZQ0KCXNlbGYuZGVmW25hbWVdLmNvdW50ID0gY291bnQNCglpZiB1bmlmaWVkX2ludmVudG9yeS5jdXJyZW50X3BhZ2VbbmFtZV0gPT0gImFybW9yIiB0aGVuDQoJCXVuaWZpZWRfaW52ZW50b3J5LnNldF9pbnZlbnRvcnlfZm9ybXNwZWMocGxheWVyLCAiYXJtb3IiKQ0KCWVuZA0KZW5k'))()
